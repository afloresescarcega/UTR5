#!/usr/bin/env python

import os
import sys
import time
import RPi.GPIO as GPIO

sys.path.append(os.path.dirname(os.path.realpath(__file__)) + "/../buttons/")

pid = str(os.getpid())
pidfile = "/tmp/robot-runit.pid"

if os.path.isfile(pidfile):
	print "%s already exists, exiting" % pidfile
	sys.exit()
file(pidfile, 'w').write(pid)

try:
	from start_button import listen_for_start
	print "RUNIT SERVICE LISTENING"
	listen_for_start()
	print "START BUTTON HAS BEEN PRESSED"
	time.sleep(60)
	print "END"
	GPIO.cleanup()

finally:
	os.unlink(pidfile)
